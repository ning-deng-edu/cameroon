import java.util.concurrent.Callable;
import java.util.*;

/*** 'Editable' - you can edit the code below based on the needs ***/
User user; // don't touch
String userid;

/*** USER ***/
onEvent("user/usertab/users", "click", "login()");

loadUsers() {
    fetchAll("select userid, fname || ' ' || lname from user where userdeleted is null", new FetchCallback() {
        onFetch(result) {
            populateList("user/usertab/users", result);
        }
    });
}


loadUsers();

String username = "";
String device = "";
login() {
    fetchOne("select userid,fname,lname,email from user where userid='" + getListItemValue() + "';", new FetchCallback() {
        onFetch(result) {
            user = new User(result.get(0),result.get(1),result.get(2),result.get(3));
            setUser(user);
            username = result.get(1) + " " + result.get(2);
            showTabGroup("control");
        }
    });
}


/*** QuestionBank ***/
question_id=null;
onEvent("control/question_control/New_Question","click","newQuestion()");
onEvent("questionBank/questionInfo/Finish_New_Question","click","saveNewQuestion()");

newQuestion(){
	newTabGroup("questionBank");
	onEvent("questionBank", "show", "showTab(\"questionBank/questionInfo\");");  
}
saveNewQuestion(){
	/*if(isNull(getFieldValue("questionBank/questionInfo/questionID"))){
		showWarning("Validation Error", "You must fill in the Question ID before you can continue");
		return;
	}*/
	if(isNull(getFieldValue("questionBank/questionInfo/questionContent"))){
		showWarning("Validation Error", "You must fill in the Question Content before you can continue");
		return;
	}
	saveTabGroup("questionBank", question_id, null, null, new SaveCallback() {
	showWarning("saveTabGroup","----");
    onSave(uuid, newRecord) {
      showWarning("onSave()","oooo");
      question_id = uuid;
      showWarning("saved question ", uuid);
      if (newRecord) {
        showToast("New record created");
      }
    }
    onError(message) {
        showWarning("error",message);
    }  
  });
}

